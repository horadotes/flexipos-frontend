select 
1111 AS `SourceDoc`,`flexipos`.`bills`.`BillDate` 
AS `TranDate`,`flexipos`.`bills`.`SalesInvoiceNo` 
AS `RefDoc`,`flexipos`.`billdetails`.`ProductNo` 
AS `ProductNo`,`flexipos`.`products`.`ProductName` 
AS `ProductName`,`flexipos`.`products`.`BrandName` 
AS `BrandName`,`flexipos`.`billdetails`.`LotNo` 
AS `LotNo`,`flexipos`.`billdetails`.`ExpiryDate` 
AS `ExpiryDate`,`flexipos`.`billdetails`.`CostPerQty`
 AS `CostPerQty`,`flexipos`.`products`.`RetailUnit`
 AS `RetailUnit`,((case when (`flexipos`.`billdetails`.`Unit` = `flexipos`.`products`.`WholeSaleUnit`) 
then (`flexipos`.`billdetails`.`Qty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`billdetails`.`Qty` end) +
 (case when (`flexipos`.`billdetails`.`FreebiesUnit` = `flexipos`.`products`.`WholeSaleUnit`) 
then (`flexipos`.`billdetails`.`FreebiesQty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) 
else `flexipos`.`billdetails`.`FreebiesQty` end)) 
AS `RetailSaleQty` from ((((`flexipos`.`bills` join `flexipos`.`billdetails` on((`flexipos`.`bills`.`id` = `flexipos`.`billdetails`.`BillNo`))) join `flexipos`.`products` on((`flexipos`.`billdetails`.`ProductNo` = `flexipos`.`products`.`id`))) join `flexipos`.`productcategories` on((`flexipos`.`products`.`ProductCatNo` = `flexipos`.`productcategories`.`id`))) join `flexipos`.`branches` on((`flexipos`.`bills`.`BranchNo` = `flexipos`.`branches`.`id`))) where (`flexipos`.`bills`.`IsCancelled` = 'N') union all select 2222 AS `SourceDoc`,`flexipos`.`salesinvoices`.`InvoiceDate` AS `TranDate`,`flexipos`.`salesinvoices`.`SalesInvoiceRefDocNo` AS `RefDoc`,`flexipos`.`salesinvoicedetails`.`ProductNo` AS `ProductNo`,`flexipos`.`products`.`ProductName` AS `ProductName`,`flexipos`.`products`.`BrandName` AS `BrandName`,`flexipos`.`salesinvoicedetails`.`LotNo` AS `LotNo`,`flexipos`.`salesinvoicedetails`.`ExpiryDate` AS `ExpiryDate`,0.00 AS `CostPerQty`,`flexipos`.`products`.`RetailUnit` AS `RetailUnit`,(((case when (`flexipos`.`salesinvoicedetails`.`Unit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`salesinvoicedetails`.`Qty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`salesinvoicedetails`.`Qty` end) + (case when (`flexipos`.`salesinvoicedetails`.`FreebiesUnit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`salesinvoicedetails`.`FreebiesQty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`salesinvoicedetails`.`FreebiesQty` end)) * -(1)) AS `RetailSaleQty` from ((((`flexipos`.`salesinvoices` join `flexipos`.`salesinvoicedetails` on((`flexipos`.`salesinvoices`.`id` = `flexipos`.`salesinvoicedetails`.`SalesInvoiceNo`))) join `flexipos`.`products` on((`flexipos`.`salesinvoicedetails`.`ProductNo` = `flexipos`.`products`.`id`))) join `flexipos`.`productcategories` on((`flexipos`.`products`.`ProductCatNo` = `flexipos`.`productcategories`.`id`))) join `flexipos`.`branches` on((`flexipos`.`salesinvoices`.`BranchNo` = `flexipos`.`branches`.`id`))) where (`flexipos`.`salesinvoices`.`IsCancelled` = 'N') union all select 3333 AS `SourceDoc`,`flexipos`.`supplierreturns`.`ReturnDate` AS `TranDate`,`flexipos`.`bills`.`SalesInvoiceNo` AS `RefDoc`,`flexipos`.`products`.`id` AS `Id`,`flexipos`.`products`.`ProductName` AS `ProductName`,`flexipos`.`products`.`BrandName` AS `BrandName`,`flexipos`.`supplierreturndetails`.`LotNo` AS `LotNo`,`flexipos`.`supplierreturndetails`.`ExpiryDate` AS `ExpiryDate`,`flexipos`.`supplierreturndetails`.`CostPerQty` AS `CostPerQty`,`flexipos`.`products`.`RetailUnit` AS `RetailUnit`,(((case when (`flexipos`.`supplierreturndetails`.`Unit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`supplierreturndetails`.`Qty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`supplierreturndetails`.`Qty` end) + (case when (`flexipos`.`supplierreturndetails`.`FreebiesUnit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`supplierreturndetails`.`FreebiesQty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`supplierreturndetails`.`FreebiesQty` end)) * -(1)) AS `RetailSaleQty` from (((((`flexipos`.`supplierreturns` join `flexipos`.`supplierreturndetails` on((`flexipos`.`supplierreturns`.`id` = `flexipos`.`supplierreturndetails`.`SupplierReturnNo`))) join `flexipos`.`products` on((`flexipos`.`supplierreturndetails`.`ProductNo` = `flexipos`.`products`.`id`))) join `flexipos`.`productcategories` on((`flexipos`.`products`.`ProductCatNo` = `flexipos`.`productcategories`.`id`))) join `flexipos`.`bills` on((`flexipos`.`supplierreturns`.`BillNo` = `flexipos`.`bills`.`id`))) join `flexipos`.`branches` on((`flexipos`.`supplierreturns`.`BranchNo` = `flexipos`.`branches`.`id`))) where (`flexipos`.`supplierreturns`.`IsCancelled` = 'N') union all select 4444 AS `SourceDoc`,`flexipos`.`customerreturns`.`CustomerReturnDate` AS `TranDate`,`flexipos`.`customerreturns`.`SalesinvoiceNo` AS `RefDoc`,`flexipos`.`products`.`id` AS `Id`,`flexipos`.`products`.`ProductName` AS `ProductName`,`flexipos`.`products`.`BrandName` AS `BrandName`,`flexipos`.`customerreturndetails`.`LotNo` AS `LotNo`,`flexipos`.`customerreturndetails`.`ExpiryDate` AS `ExpiryDate`,0.00 AS `CostPerQty`,`flexipos`.`products`.`RetailUnit` AS `RetailUnit`,((case when (`flexipos`.`customerreturndetails`.`Unit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`customerreturndetails`.`Qty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`customerreturndetails`.`Qty` end) + (case when (`flexipos`.`customerreturndetails`.`FreebiesUnit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`customerreturndetails`.`FreebiesQty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`customerreturndetails`.`FreebiesQty` end)) AS `RetailSaleQty` from ((((`flexipos`.`customerreturns` join `flexipos`.`customerreturndetails` on((`flexipos`.`customerreturns`.`id` = `flexipos`.`customerreturndetails`.`CustomerReturnNo`))) join `flexipos`.`products` on((`flexipos`.`customerreturndetails`.`ProductNo` = `flexipos`.`products`.`id`))) join `flexipos`.`productcategories` on((`flexipos`.`products`.`ProductCatNo` = `flexipos`.`productcategories`.`id`))) join `flexipos`.`branches` on((`flexipos`.`customerreturns`.`BranchNo` = `flexipos`.`branches`.`id`))) where (`flexipos`.`customerreturns`.`IsCancelled` = 'N') union all select 5555 AS `SourceDoc`,`flexipos`.`inventoryadjustments`.`AdjustmentDate` AS `TranDate`,`flexipos`.`inventoryadjustments`.`id` AS `RefDoc`,`flexipos`.`inventoryadjustmentdetails`.`ProductNo` AS `ProductNo`,`flexipos`.`products`.`ProductName` AS `ProductName`,`flexipos`.`products`.`BrandName` AS `BrandName`,`flexipos`.`inventoryadjustmentdetails`.`LotNo` AS `LotNo`,`flexipos`.`inventoryadjustmentdetails`.`ExpiryDate` AS `ExpiryDate`,`flexipos`.`inventoryadjustmentdetails`.`CostPerQty` AS `CostPerQty`,`flexipos`.`products`.`RetailUnit` AS `RetailUnit`,(case when (`flexipos`.`inventoryadjustmentdetails`.`Unit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`inventoryadjustmentdetails`.`Qty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`inventoryadjustmentdetails`.`Qty` end) AS `RetailSaleQty` from ((((`flexipos`.`inventoryadjustments` join `flexipos`.`inventoryadjustmentdetails` on((`flexipos`.`inventoryadjustments`.`id` = `flexipos`.`inventoryadjustmentdetails`.`InvAdjustmentNo`))) join `flexipos`.`products` on((`flexipos`.`inventoryadjustmentdetails`.`ProductNo` = `flexipos`.`products`.`id`))) join `flexipos`.`productcategories` on((`flexipos`.`products`.`ProductCatNo` = `flexipos`.`productcategories`.`id`))) join `flexipos`.`branches` on((`flexipos`.`inventoryadjustments`.`BranchNo` = `flexipos`.`branches`.`id`))) where (`flexipos`.`inventoryadjustments`.`IsCancelled` = 'N') union all select 6666 AS `SourceDoc`,`flexipos`.`inventorydamages`.`InvDamageDate` AS `TranDate`,`flexipos`.`inventorydamages`.`id` AS `RefDoc`,`flexipos`.`inventorydamagedetails`.`ProductNo` AS `ProductNo`,`flexipos`.`products`.`ProductName` AS `ProductName`,`flexipos`.`products`.`BrandName` AS `BrandName`,`flexipos`.`inventorydamagedetails`.`LotNo` AS `LotNo`,`flexipos`.`inventorydamagedetails`.`ExpiryDate` AS `ExpiryDate`,`flexipos`.`inventorydamagedetails`.`CostPerQty` AS `CostPerQty`,`flexipos`.`products`.`RetailUnit` AS `RetailUnit`,((case when (`flexipos`.`inventorydamagedetails`.`Unit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`inventorydamagedetails`.`Qty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`inventorydamagedetails`.`Qty` end) * -(1)) AS `RetailSaleQty` from ((((`flexipos`.`inventorydamages` join `flexipos`.`inventorydamagedetails` on((`flexipos`.`inventorydamages`.`id` = `flexipos`.`inventorydamagedetails`.`InvDamagesNo`))) join `flexipos`.`products` on((`flexipos`.`inventorydamagedetails`.`ProductNo` = `flexipos`.`products`.`id`))) join `flexipos`.`productcategories` on((`flexipos`.`products`.`ProductCatNo` = `flexipos`.`productcategories`.`id`))) join `flexipos`.`branches` on((`flexipos`.`inventorydamages`.`BranchNo` = `flexipos`.`branches`.`id`))) where (`flexipos`.`inventorydamages`.`IsCancelled` = 'N') union all select 7777 AS `SourceDoc`,`flexipos`.`stocktransfers`.`TransferDate` AS `TranDate`,`flexipos`.`stocktransfers`.`id` AS `RefDoc`,`flexipos`.`stocktransferdetails`.`ProductNo` AS `ProductNo`,`flexipos`.`products`.`ProductName` AS `ProductName`,`flexipos`.`products`.`BrandName` AS `BrandName`,`flexipos`.`stocktransferdetails`.`LotNo` AS `LotNo`,`flexipos`.`stocktransferdetails`.`ExpiryDate` AS `ExpiryDate`,`flexipos`.`stocktransferdetails`.`CostPerUnit` AS `CostPerUnit`,`flexipos`.`products`.`RetailUnit` AS `RetailUnit`,((case when (`flexipos`.`stocktransferdetails`.`Unit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`stocktransferdetails`.`Qty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`stocktransferdetails`.`Qty` end) * -(1)) AS `RetailSaleQty` from ((((`flexipos`.`stocktransfers` join `flexipos`.`stocktransferdetails` on((`flexipos`.`stocktransfers`.`id` = `flexipos`.`stocktransferdetails`.`StockTransferNo`))) join `flexipos`.`products` on((`flexipos`.`stocktransferdetails`.`ProductNo` = `flexipos`.`products`.`id`))) join `flexipos`.`productcategories` on((`flexipos`.`products`.`ProductCatNo` = `flexipos`.`productcategories`.`id`))) join `flexipos`.`branches` on((`flexipos`.`stocktransfers`.`BranchSourceNo` = `flexipos`.`branches`.`id`))) where (`flexipos`.`stocktransfers`.`IsCancelled` = 'N') union all select 8888 AS `SourceDoc`,`flexipos`.`stocktransfers`.`TransferDate` AS `TranDate`,`flexipos`.`stocktransfers`.`id` AS `RefDoc`,`flexipos`.`stocktransferdetails`.`ProductNo` AS `ProductNo`,`flexipos`.`products`.`ProductName` AS `ProductName`,`flexipos`.`products`.`BrandName` AS `BrandName`,`flexipos`.`stocktransferdetails`.`LotNo` AS `LotNo`,`flexipos`.`stocktransferdetails`.`ExpiryDate` AS `ExpiryDate`,`flexipos`.`stocktransferdetails`.`CostPerUnit` AS `CostPerUnit`,`flexipos`.`products`.`RetailUnit` AS `RetailUnit`,(case when (`flexipos`.`stocktransferdetails`.`Unit` = `flexipos`.`products`.`WholeSaleUnit`) then (`flexipos`.`stocktransferdetails`.`Qty` * `flexipos`.`products`.`RetailQtyPerWholeSaleUnit`) else `flexipos`.`stocktransferdetails`.`Qty` end) AS `RetailSaleQty` from ((((`flexipos`.`stocktransfers` join `flexipos`.`stocktransferdetails` on((`flexipos`.`stocktransfers`.`id` = `flexipos`.`stocktransferdetails`.`StockTransferNo`))) join `flexipos`.`products` on((`flexipos`.`stocktransferdetails`.`ProductNo` = `flexipos`.`products`.`id`))) join `flexipos`.`productcategories` on((`flexipos`.`products`.`ProductCatNo` = `flexipos`.`productcategories`.`id`))) join `flexipos`.`branches` on((`flexipos`.`stocktransfers`.`BranchDestinationNo` = `flexipos`.`branches`.`id`))) where (`flexipos`.`stocktransfers`.`IsCancelled` = 'N')